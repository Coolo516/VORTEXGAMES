<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VORTEX</title>
    <link rel="stylesheet" href="styles.css">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
</head>
<body>

    <!-- Password Login Screen -->
    <div id="login-screen">
        <div class="login-box">
            <h1 class="title">VORTEX</h1>
            <p>Enter Password</p>
            <input type="password" id="password-input" placeholder="Password" autocomplete="off">
            <button onclick="checkPassword()">Enter</button>
            <p id="error-msg" style="color: red; margin-top: 10px; display: none;">Wrong password!</p>
        </div>
    </div>

    <!-- Admin Panel -->
    <div id="admin-panel" style="display: none;">
        <div class="admin-box">
            <h2>Admin Panel</h2>

            <!-- Add New Passwords -->
            <div style="margin-bottom: 20px;">
                <input type="text" id="new-admin-pass" placeholder="New Admin Password">
                <button onclick="addAdminPassword()">Add Admin Password</button>
            </div>
            <div style="margin-bottom: 20px;">
                <input type="text" id="new-user-pass" placeholder="New User Password">
                <button onclick="addUserPassword()">Add User Password</button>
            </div>

            <!-- Delete Password -->
            <div style="margin-bottom: 30px;">
                <input type="text" id="delete-pass" placeholder="Type password to delete">
                <button onclick="deletePassword()" style="background: #ff4444;">Delete Password</button>
            </div>

            <!-- Activity Log -->
            <h3 style="margin-top: 30px;">Activity Log</h3>
            <div id="activity-log" style="max-height: 300px; overflow-y: auto; background: #001122; padding: 15px; border-radius: 10px; border: 1px solid #00ffff;">
                Loading logs...
            </div>

            <button onclick="logout()" style="margin-top: 30px; background: #ff0000;">Back to Login</button>
        </div>
    </div>

    <!-- Main Site -->
    <div id="main-site" style="display: none;">
        <button class="logout-btn" onclick="logout()">Logout</button>

        <!-- Home Screen -->
        <div id="home-screen">
            <h1 class="title">VORTEX</h1>
            <p class="subtitle">Unleash the Power</p>
            <div class="options">
                <button onclick="showSection('games')">Games</button>
                <button onclick="showSection('apps')">Apps</button>
                <button onclick="showAdmin()" id="admin-btn" style="display: none;">Admin Panel</button>
            </div>
        </div>

        <!-- Games Section -->
        <div id="games-section" class="section" style="display: none;">
            <button class="back-btn" onclick="showHome()">← Back</button>
            <h1 class="section-title">VORTEX Games</h1>
            
            <div class="game-list">
                <!-- All your 30+ games -->
                <div class="game-card"><h2>Five Nights at Freddy's 1</h2><button onclick="loadContent('https://irv77.github.io/hd_fnaf/1/', 'games')">Play</button></div>
                <!-- ... (keep all your games from previous version) ... -->
                <div class="game-card"><h2>Tanuki Sunset</h2><p style="color: #00aaff; font-size: 0.9em;">Raccoon skateboarding</p><button onclick="loadContent('https://tanukisunset.io/', 'games')">Play</button></div>
            </div>
        </div>

        <!-- Apps Section -->
        <div id="apps-section" class="section" style="display: none;">
            <button class="back-btn" onclick="showHome()">← Back</button>
            <h1 class="section-title">VORTEX Apps</h1>
            
            <div class="game-list">
                <div class="game-card"><h2>Interstellar Proxy</h2><p style="color: #00aaff; font-size: 0.9em;">Fast proxy with games & cloaking</p><button onclick="loadContent('https://darklight.neo-space.space', 'apps')">Launch</button></div>
                <div class="game-card"><h2>Space Proxy</h2><p style="color: #00aaff; font-size: 0.9em;">Another powerful web proxy</p><button onclick="loadContent('https://dash.ddnssec.de', 'apps')">Launch</button></div>
                <div class="game-card"><h2>DaydreamX Proxy</h2><p style="color: #00aaff; font-size: 0.9em;">Advanced web proxy & unblocker</p><button onclick="loadContent('https://shop.ddnssec.de/', 'apps')">Launch</button></div>
            </div>
        </div>

        <!-- Full-Screen Player -->
        <div id="player" class="player" style="display: none;">
            <button class="back-overlay" onclick="hideContent()">← Back</button>
            <div id="loading-spinner" class="loading-spinner">
                <div class="spinner"></div>
                <p>Loading Game...</p>
            </div>
            <iframe id="content-iframe" frameborder="0" allowfullscreen allow="fullscreen" onload="document.getElementById('loading-spinner').style.display='none';"></iframe>
        </div>
    </div>

    <script>
        // === YOUR FIREBASE CONFIG - CHANGE THIS ===
        const firebaseConfig = {
            databaseURL: "https://vortex-eb4a0-default-rtdb.firebaseio.com/"  // ← Replace with your actual URL
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        const adminRef = db.ref('adminPasswords');
        const userRef = db.ref('userPasswords');
        const logRef = db.ref('activityLog');

        let isAdmin = false;

        // Load data on start
        window.onload = () => {
            document.getElementById('main-site').style.display = 'none';
            document.getElementById('admin-panel').style.display = 'none';
            document.getElementById('login-screen').style.display = 'block';

            // Listen for real-time updates
            logRef.on('value', (snapshot) => {
                const logs = snapshot.val() || [];
                updateActivityLog(logs);
            });
        };

        function updateActivityLog(logs) {
            const logDiv = document.getElementById('activity-log');
            logDiv.innerHTML = '';
            logs.slice().reverse().forEach(entry => {
                const p = document.createElement('p');
                p.textContent = entry;
                p.style.margin = '8px 0';
                p.style.fontSize = '0.9em';
                logDiv.appendChild(p);
            });
            if (logs.length === 0) logDiv.innerHTML = 'No activity yet.';
        }

        function logLogin(passwordUsed) {
            const now = new Date();
            const time = now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
            const date = now.toLocaleDateString();
            const entry = `Login successful! Password: ${passwordUsed} | Time: ${time} | Date: ${date}`;

            logRef.transaction(current => {
                if (!current) current = [];
                current.push(entry);
                return current;
            });
        }

        function checkPassword() {
            const input = document.getElementById('password-input').value.trim();

            // Check admin first
            adminRef.once('value').then(snapshot => {
                const admins = snapshot.val() || ['vortexontopfr'];
                if (admins.includes(input)) {
                    isAdmin = true;
                    logLogin(input);
                    showMainSite();
                    document.getElementById('admin-btn').style.display = 'block';
                    return;
                }

                // Then check user
                userRef.once('value').then(snapshot2 => {
                    const users = snapshot2.val() || [];
                    if (users.includes(input)) {
                        isAdmin = false;
                        logLogin(input);
                        showMainSite();
                        document.getElementById('admin-btn').style.display = 'none';
                    } else {
                        document.getElementById('error-msg').style.display = 'block';
                    }
                });
            });
        }

        function showMainSite() {
            document.getElementById('login-screen').style.display = 'none';
            document.getElementById('main-site').style.display = 'block';
            showHome();
        }

        function showAdmin() {
            document.getElementById('main-site').style.display = 'none';
            document.getElementById('admin-panel').style.display = 'block';
        }

        function addAdminPassword() {
            const pass = document.getElementById('new-admin-pass').value.trim();
            if (!pass) return alert('Enter a password');

            adminRef.transaction(current => {
                if (!current) current = ['vortexontopfr'];
                if (!current.includes(pass)) current.push(pass);
                return current;
            }).then(() => {
                alert('Admin password added!');
                document.getElementById('new-admin-pass').value = '';
            });
        }

        function addUserPassword() {
            const pass = document.getElementById('new-user-pass').value.trim();
            if (!pass) return alert('Enter a password');

            userRef.transaction(current => {
                if (!current) current = [];
                if (!current.includes(pass)) current.push(pass);
                return current;
            }).then(() => {
                alert('User password added!');
                document.getElementById('new-user-pass').value = '';
            });
        }

        function deletePassword() {
            const pass = document.getElementById('delete-pass').value.trim();
            if (!pass) return alert('Enter a password');

            // Try admin first
            adminRef.transaction(current => {
                if (current && current.includes(pass)) {
                    return current.filter(p => p !== pass);
                }
                return current;
            }).then(() => {
                userRef.transaction(current => {
                    if (current && current.includes(pass)) {
                        return current.filter(p => p !== pass);
                    }
                    return current;
                }).then(() => {
                    alert('Password deleted if it existed!');
                    document.getElementById('delete-pass').value = '';
                });
            });
        }

        function logout() {
            document.getElementById('main-site').style.display = 'none';
            document.getElementById('admin-panel').style.display = 'none';
            document.getElementById('login-screen').style.display = 'block';
            document.getElementById('password-input').value = '';
            document.getElementById('error-msg').style.display = 'none';
            hideContent();
        }

        // Your existing navigation, player, and trail effect code (unchanged)
        let currentSection = '';

        function showHome() {
            document.getElementById('home-screen').style.display = 'flex';
            document.getElementById('games-section').style.display = 'none';
            document.getElementById('apps-section').style.display = 'none';
            document.getElementById('player').style.display = 'none';
        }

        function showSection(section) {
            document.getElementById('home-screen').style.display = 'none';
            document.getElementById('games-section').style.display = section === 'games' ? 'block' : 'none';
            document.getElementById('apps-section').style.display = section === 'apps' ? 'block' : 'none';
        }

        function loadContent(url, section) {
            const iframe = document.getElementById('content-iframe');
            const player = document.getElementById('player');
            const spinner = document.getElementById('loading-spinner');
            
            currentSection = section;
            iframe.src = url;
            spinner.style.display = 'block';
            player.style.display = 'flex';
            document.getElementById('games-section').style.display = 'none';
            document.getElementById('apps-section').style.display = 'none';
        }

        function hideContent() {
            const iframe = document.getElementById('content-iframe');
            const player = document.getElementById('player');
            
            iframe.src = '';
            player.style.display = 'none';
            
            if (currentSection === 'games') {
                document.getElementById('games-section').style.display = 'block';
            } else if (currentSection === 'apps') {
                document.getElementById('apps-section').style.display = 'block';
            }
        }

        // Continuous Blue Trail Effect
        document.addEventListener('mousemove', (e) => {
            const particle = document.createElement('div');
            particle.classList.add('trail-particle');
            
            const size = Math.random() * 10 + 5;
            particle.style.width = `${size}px`;
            particle.style.height = `${size}px`;
            
            particle.style.left = `${e.clientX}px`;
            particle.style.top = `${e.clientY}px`;
            
            const offsetX = Math.random() * 20 - 10;
            const offsetY = Math.random() * 20 - 10;
            particle.style.transform = `translate(${offsetX}px, ${offsetY}px)`;

            const duration = Math.random() * 0.7 + 0.8;
            particle.style.animationDuration = `${duration}s`;

            document.body.appendChild(particle);

            particle.addEventListener('animationend', () => {
                particle.remove();
            });
        });
    </script>
</body>
</html>
